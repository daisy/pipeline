<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html vocab="http://www.daisy.org/ns/pipeline/" typeof="source">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta charset="utf-8">
<meta http-equiv="content-language" content="en">
<link rel="stylesheet" type="text/css" href="/pipeline/css/nxml-mode.css">
<link rel="shortcut icon" href="http://www.daisy.org/sites/default/files/favicon_0.ico">
<link rev="doc" href="../library.xpl">
</head>
<body><div class="code" about="../library.xpl">&lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">library</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">p</span>=<span class="code-xml-attribute-value">"http://www.w3.org/ns/xproc"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">px</span>=<span class="code-xml-attribute-value">"http://www.daisy.org/ns/pipeline/xproc"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">html</span>=<span class="code-xml-attribute-value">"http://www.w3.org/1999/xhtml"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">ssml</span>=<span class="code-xml-attribute-value">"http://www.w3.org/2001/10/synthesis"</span> <span class="code-xml-attribute-local-name">version</span>=<span class="code-xml-attribute-value">"1.0"</span>&gt;

  &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">declare-step</span> <span class="code-xml-attribute-local-name">type</span>=<span class="code-xml-attribute-value">"px:html-break-detect"</span>&gt;

    &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">documentation</span>&gt;Break an input XHTML document into words and sentences by inserting word and sentence elements.&lt;/<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">documentation</span>&gt;

    &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">input</span> <span class="code-xml-attribute-local-name">port</span>=<span class="code-xml-attribute-value">"source"</span> <span class="code-xml-attribute-local-name">primary</span>=<span class="code-xml-attribute-value">"true"</span>/&gt;
    &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">output</span> <span class="code-xml-attribute-local-name">port</span>=<span class="code-xml-attribute-value">"result"</span> <span class="code-xml-attribute-local-name">primary</span>=<span class="code-xml-attribute-value">"true"</span>/&gt;
    &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">output</span> <span class="code-xml-attribute-local-name">port</span>=<span class="code-xml-attribute-value">"sentence-ids"</span>&gt;
      &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">pipe</span> <span class="code-xml-attribute-local-name">port</span>=<span class="code-xml-attribute-value">"sentence-ids"</span> <span class="code-xml-attribute-local-name">step</span>=<span class="code-xml-attribute-value">"generic"</span>/&gt;
    &lt;/<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">output</span>&gt;

    &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">option</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"id-prefix"</span> <span class="code-xml-attribute-local-name">required</span>=<span class="code-xml-attribute-value">"false"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"''"</span>/&gt;

    &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">option</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sentence-attr"</span> <span class="code-xml-attribute-local-name">required</span>=<span class="code-xml-attribute-value">"false"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"''"</span>&gt;
      &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">documentation</span> <span class="code-xml-attribute-prefix">xmlns</span>=<span class="code-xml-attribute-value">"http://www.w3.org/1999/xhtml"</span>&gt;
        &lt;<span class="code-xml-element-local-name">p</span>&gt;Attribute to be added to sentence &lt;<span class="code-xml-element-local-name">code</span>&gt;span&lt;/<span class="code-xml-element-local-name">code</span>&gt; elements.&lt;/<span class="code-xml-element-local-name">p</span>&gt;
      &lt;/<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">documentation</span>&gt;
    &lt;/<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">option</span>&gt;

    &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">option</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sentence-attr-val"</span> <span class="code-xml-attribute-local-name">required</span>=<span class="code-xml-attribute-value">"false"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"''"</span>&gt;
      &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">documentation</span> <span class="code-xml-attribute-prefix">xmlns</span>=<span class="code-xml-attribute-value">"http://www.w3.org/1999/xhtml"</span>&gt;
        &lt;<span class="code-xml-element-local-name">p</span>&gt;Corresponding attribute value.&lt;/<span class="code-xml-element-local-name">p</span>&gt;
        &lt;<span class="code-xml-element-local-name">p</span>&gt;&lt;<span class="code-xml-element-local-name">code</span>&gt;span&lt;/<span class="code-xml-element-local-name">code</span>&gt; elements in the input that are already marked up as sentences using the
        specified attribute and value are preserved. No additional sentence detection is performed
        within such elements.&lt;/<span class="code-xml-element-local-name">p</span>&gt;
      &lt;/<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">documentation</span>&gt;
    &lt;/<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">option</span>&gt;

    &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">import</span> <span class="code-xml-attribute-local-name">href</span>=<span class="code-xml-attribute-value">"<a href="/pipeline/modules/nlp-common/src/main/resources/xml/library.xpl" class="source">http://www.daisy.org/pipeline/modules/nlp-common/library.xpl</a>"</span>&gt;
      &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">documentation</span>&gt;
        px:break-and-reshape
      &lt;/<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">documentation</span>&gt;
    &lt;/<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">import</span>&gt;

    &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"existing-sentence-match-pattern"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"if ($sentence-attr!='')                         then concat('html:span[@',$sentence-attr,'="',                                     replace($sentence-attr-val,'"','""'),                                     '"]')                         else ''"</span>/&gt;

    
    
    &lt;<span class="code-xml-element-prefix">px:</span><span class="code-xml-element-local-name">break-and-reshape</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"generic"</span> <span class="code-xml-attribute-local-name">inline-tags</span>=<span class="code-xml-attribute-value">"html:span|html:i|html:b|html:a|html:br|html:del|html:font|html:ruby|html:s|                      html:small|html:strike|html:strong|html:sup|html:sub|html:u|html:q|html:address|                      html:abbr|html:em|html:style|ssml:phoneme"</span> <span class="code-xml-attribute-local-name">ensure-word-before</span>=<span class="code-xml-attribute-value">"html:span|html:br|html:ruby|html:s|html:address|html:abbr|html:style"</span> <span class="code-xml-attribute-local-name">ensure-word-after</span>=<span class="code-xml-attribute-value">"span|html:br|html:ruby|html:s|html:address|html:abbr|html:style"</span> <span class="code-xml-attribute-local-name">can-contain-sentences</span>=<span class="code-xml-attribute-value">"html:body|html:section|html:nav|html:article|html:aside|html:h1|html:h2|                                html:h3|html:h4|html:h5|html:h6|html:header|html:footer|html:address|                                html:p|html:pre|html:blockquote|html:li|html:dt|html:dd|html:a|html:q|                                html:cite|html:em|html:strong|html:small|html:mark|html:dfn|html:abbr|                                html:time|html:progress|html:meter|html:code|html:var|html:samp|html:kdb|                                html:sub|html:sup|html:span|html:i|html:b|html:bdo|html:rt|html:ins|                                html:del|html:caption|html:figcaption|html:td|html:th|html:form|html:label|                                html:input|html:button|html:datalist|html:output|html:bb|html:menu|                                html:legend|html:div"</span> <span class="code-xml-attribute-local-name">output-ns</span>=<span class="code-xml-attribute-value">"http://www.w3.org/1999/xhtml"</span> <span class="code-xml-attribute-local-name">output-word-tag</span>=<span class="code-xml-attribute-value">"span"</span> <span class="code-xml-attribute-local-name">word-attr</span>=<span class="code-xml-attribute-value">"role"</span> <span class="code-xml-attribute-local-name">word-attr-val</span>=<span class="code-xml-attribute-value">"word"</span> <span class="code-xml-attribute-local-name">output-sentence-tag</span>=<span class="code-xml-attribute-value">"span"</span> <span class="code-xml-attribute-local-name">output-subsentence-tag</span>=<span class="code-xml-attribute-value">"span"</span> <span class="code-xml-attribute-local-name">exclusive-sentence-tag</span>=<span class="code-xml-attribute-value">"false"</span> <span class="code-xml-attribute-local-name">exclusive-word-tag</span>=<span class="code-xml-attribute-value">"false"</span>&gt;
      &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">with-option</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"id-prefix"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$id-prefix"</span>/&gt;
      &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">with-option</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sentence-attr"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$sentence-attr"</span>/&gt;
      &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">with-option</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sentence-attr-val"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$sentence-attr-val"</span>/&gt;
      &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">with-option</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"special-sentences"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$existing-sentence-match-pattern"</span>/&gt;
      &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">with-option</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"cannot-be-sentence-child"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"if ($existing-sentence-match-pattern!='')                              then concat('*[descendant-or-self::',$existing-sentence-match-pattern,']')                              else ''"</span>/&gt;
    &lt;/<span class="code-xml-element-prefix">px:</span><span class="code-xml-element-local-name">break-and-reshape</span>&gt;

  &lt;/<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">declare-step</span>&gt;

  &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">declare-step</span> <span class="code-xml-attribute-local-name">type</span>=<span class="code-xml-attribute-value">"px:html-unwrap-words"</span>&gt;
    &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">documentation</span>&gt;Remove the word markups from the input document.&lt;/<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">documentation</span>&gt;
    &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">input</span> <span class="code-xml-attribute-local-name">port</span>=<span class="code-xml-attribute-value">"source"</span> <span class="code-xml-attribute-local-name">primary</span>=<span class="code-xml-attribute-value">"true"</span>/&gt;
    &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">output</span> <span class="code-xml-attribute-local-name">port</span>=<span class="code-xml-attribute-value">"result"</span> <span class="code-xml-attribute-local-name">primary</span>=<span class="code-xml-attribute-value">"true"</span>/&gt;
    &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">unwrap</span> <span class="code-xml-attribute-local-name">match</span>=<span class="code-xml-attribute-value">"html:span[@role='word' and not(@* except @role)]"</span>/&gt;
    &lt;<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">delete</span> <span class="code-xml-attribute-local-name">match</span>=<span class="code-xml-attribute-value">"html:span/@role[.='word']"</span>/&gt;
  &lt;/<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">declare-step</span>&gt;

&lt;/<span class="code-xml-element-prefix">p:</span><span class="code-xml-element-local-name">library</span>&gt;</div></body>
</html>
