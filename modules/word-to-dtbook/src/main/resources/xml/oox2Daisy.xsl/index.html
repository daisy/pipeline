<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html vocab="http://www.daisy.org/ns/pipeline/" typeof="source">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta charset="utf-8">
<meta http-equiv="content-language" content="en">
<link rel="stylesheet" type="text/css" href="/pipeline/css/nxml-mode.css">
<link rel="shortcut icon" href="http://www.daisy.org/sites/default/files/favicon_0.ico">
<link rev="doc" href="../oox2Daisy.xsl">
</head>
<body><div class="code" about="../oox2Daisy.xsl">&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">stylesheet</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">xsl</span>=<span class="code-xml-attribute-value">"http://www.w3.org/1999/XSL/Transform"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">xs</span>=<span class="code-xml-attribute-value">"http://www.w3.org/2001/XMLSchema"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">w</span>=<span class="code-xml-attribute-value">"http://schemas.openxmlformats.org/wordprocessingml/2006/main"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">pic</span>=<span class="code-xml-attribute-value">"http://schemas.openxmlformats.org/drawingml/2006/picture"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">wp</span>=<span class="code-xml-attribute-value">"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">dcterms</span>=<span class="code-xml-attribute-value">"http://purl.org/dc/terms/"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">xsi</span>=<span class="code-xml-attribute-value">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">cp</span>=<span class="code-xml-attribute-value">"http://schemas.openxmlformats.org/package/2006/metadata/core-properties"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">ep</span>=<span class="code-xml-attribute-value">"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">dc</span>=<span class="code-xml-attribute-value">"http://purl.org/dc/elements/1.1/"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">a</span>=<span class="code-xml-attribute-value">"http://schemas.openxmlformats.org/drawingml/2006/main"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">r</span>=<span class="code-xml-attribute-value">"http://schemas.openxmlformats.org/officeDocument/2006/relationships"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">dcmitype</span>=<span class="code-xml-attribute-value">"http://purl.org/dc/dcmitype/"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">vt</span>=<span class="code-xml-attribute-value">"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">d</span>=<span class="code-xml-attribute-value">"org.daisy.pipeline.word_to_dtbook.impl.DaisyClass"</span> <span class="code-xml-attribute-prefix">xmlns</span>=<span class="code-xml-attribute-value">"http://www.daisy.org/z3986/2005/dtbook/"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">m</span>=<span class="code-xml-attribute-value">"http://schemas.openxmlformats.org/officeDocument/2006/math"</span> <span class="code-xml-attribute-prefix">xmlns:</span><span class="code-xml-attribute-local-name">mml</span>=<span class="code-xml-attribute-value">"http://www.w3.org/1998/Math/MathML"</span> <span class="code-xml-attribute-local-name">version</span>=<span class="code-xml-attribute-value">"2.0"</span> <span class="code-xml-attribute-local-name">exclude-result-prefixes</span>=<span class="code-xml-attribute-value">"w pic wp dcterms xsi cp dc a r vt dcmitype xs d m mml"</span>&gt;
	
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">output</span> <span class="code-xml-attribute-local-name">method</span>=<span class="code-xml-attribute-value">"xml"</span> <span class="code-xml-attribute-local-name">encoding</span>=<span class="code-xml-attribute-value">"UTF-8"</span>/&gt;

	
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"InputFile"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span>/&gt;
	
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"OutputDir"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span>/&gt;
	
	
	
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"title"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"''"</span>/&gt; 
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"creator"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"''"</span>/&gt; 
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"publisher"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"''"</span>/&gt; 
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"uid"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"''"</span>/&gt; 
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"subject"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"''"</span>/&gt; 
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"acceptRevisions"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:boolean"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"true()"</span>/&gt;
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"version"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"'14'"</span>/&gt; 
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"pagination"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"'custom'"</span>/&gt; 
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"MasterSub"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:boolean"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"false()"</span>/&gt;
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"ImageSizeOption"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"'original'"</span>/&gt; 
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"DPI"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:integer"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"96"</span>/&gt;
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"CharacterStyles"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:boolean"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"false()"</span>/&gt; 
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"FootnotesPosition"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"'end'"</span>/&gt; 
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"FootnotesLevel"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:integer"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"0"</span>/&gt;
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"FootnotesNumbering"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"'none'"</span>/&gt;
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"FootnotesStartValue"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:integer"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"1"</span>/&gt;
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"FootnotesNumberingPrefix"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string?"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"''"</span>/&gt;
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"FootnotesNumberingSuffix"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string?"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"''"</span>/&gt;
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"Language"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string?"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"''"</span>/&gt;
	
	
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"disableDateGeneration"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:boolean"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"false()"</span>/&gt;
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"extractShapes"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:boolean"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"true()"</span>/&gt;

	
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"myObj"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"d:new($InputFile,$OutputDir,$extractShapes)"</span>/&gt;
	
	
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"documentXml"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"document-node(element(w:document))"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"document(concat('jar:',$InputFile,'!/word/document.xml'))"</span>/&gt;
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"docPropsAppXml"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"document-node(element(ep:Properties))"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"document(concat('jar:',$InputFile,'!/docProps/app.xml'))"</span>/&gt;
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"docPropsCoreXml"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"document-node(element(cp:coreProperties))"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"document(concat('jar:',$InputFile,'!/docProps/core.xml'))"</span>/&gt;
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"stylesXml"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"document-node(element(w:styles))"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"document(concat('jar:',$InputFile,'!/word/styles.xml'))"</span>/&gt;
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"numberingXml"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"document-node(element(w:numbering))?"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"document(concat('jar:',$InputFile,'!/word/numbering.xml'))"</span>/&gt;
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"footnotesXml"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"document-node(element(w:footnotes))?"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"document(concat('jar:',$InputFile,'!/word/footnotes.xml'))"</span>/&gt;
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"endnotesXml"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"document-node(element(w:endnotes))?"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"document(concat('jar:',$InputFile,'!/word/endnotes.xml'))"</span>/&gt;
	
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"documentLanguages"</span>&gt;
		
		&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"runnerLanguages"</span>&gt;
			&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$documentXml//w:body//w:r"</span>&gt;
				&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"found"</span>&gt;
					&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">call-template</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"GetRunLanguage"</span>&gt;
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"runNode"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"."</span>/&gt;
					&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">call-template</span>&gt;
				&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span>&gt;
				&lt;<span class="code-xml-element-local-name">lang</span> <span class="code-xml-attribute-local-name">val</span>=<span class="code-xml-attribute-value">"{$found}"</span>/&gt;
			&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span>&gt;
		&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span>&gt;
		
		&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"uniqRunnerLanguages"</span>&gt;
			&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$runnerLanguages/*:lang"</span>&gt;
				&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"currentVal"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"@*:val"</span>/&gt;
				&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"count(preceding-sibling::*:lang[@*:val=$currentVal])=0"</span>&gt;
					&lt;<span class="code-xml-element-local-name">lang</span> <span class="code-xml-attribute-local-name">val</span>=<span class="code-xml-attribute-value">"{$currentVal}"</span>/&gt;
				&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
			&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span>&gt;
		&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span>&gt;
		
		&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"paragraphLanguages"</span>&gt;
			&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$documentXml//w:body//w:p"</span>&gt;
				&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"found"</span>&gt;
					&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">call-template</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"GetParagraphLanguage"</span>&gt;
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"paragraphNode"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"."</span>/&gt;
					&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">call-template</span>&gt;
				&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span>&gt;
				&lt;<span class="code-xml-element-local-name">lang</span> <span class="code-xml-attribute-local-name">val</span>=<span class="code-xml-attribute-value">"{$found}"</span>/&gt;
			&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span>&gt;
			
			&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$uniqRunnerLanguages/*:lang"</span>&gt;
				&lt;<span class="code-xml-element-local-name">lang</span> <span class="code-xml-attribute-local-name">val</span>=<span class="code-xml-attribute-value">"{@*:val}"</span>/&gt;
			&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span>&gt;
		&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span>&gt;
		
		
		&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"uniqLanguages"</span>&gt;
			&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$paragraphLanguages/*:lang"</span>&gt;
				&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"currentVal"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"@*:val"</span>/&gt;
				&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"count(preceding-sibling::*:lang[@*:val=$currentVal])=0"</span>&gt;
					&lt;<span class="code-xml-element-local-name">lang</span> <span class="code-xml-attribute-local-name">val</span>=<span class="code-xml-attribute-value">"{$currentVal}"</span> <span class="code-xml-attribute-local-name">count</span>=<span class="code-xml-attribute-value">"{count(following-sibling::*:lang[@*:val=$currentVal]) + 1}"</span>/&gt;
				&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
			&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span>&gt;
		&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span>&gt;
		&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"$Language and string-length($Language) &gt; 0"</span>&gt;
			&lt;<span class="code-xml-element-local-name">lang</span> <span class="code-xml-attribute-local-name">val</span>=<span class="code-xml-attribute-value">"{@*:val}"</span>/&gt;
		&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
		&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$uniqLanguages/*:lang"</span>&gt;
			&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">sort</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"@*:count"</span> <span class="code-xml-attribute-local-name">data-type</span>=<span class="code-xml-attribute-value">"number"</span> <span class="code-xml-attribute-local-name">order</span>=<span class="code-xml-attribute-value">"descending"</span>/&gt;
			&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"not($Language = @*:val)"</span>&gt;
				&lt;<span class="code-xml-element-local-name">lang</span> <span class="code-xml-attribute-local-name">val</span>=<span class="code-xml-attribute-value">"{@*:val}"</span>/&gt;
			&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
			
		&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span>&gt;
	&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span>&gt;
	
	
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">import</span> <span class="code-xml-attribute-local-name">href</span>=<span class="code-xml-attribute-value">"<a href="/pipeline/modules/word-to-dtbook/src/main/resources/xml/Common.xsl" class="source">Common.xsl</a>"</span>/&gt;
	
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">import</span> <span class="code-xml-attribute-local-name">href</span>=<span class="code-xml-attribute-value">"<a href="/pipeline/modules/word-to-dtbook/src/main/resources/xml/TOC.xsl" class="source">TOC.xsl</a>"</span>/&gt;
	
	
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">import</span> <span class="code-xml-attribute-local-name">href</span>=<span class="code-xml-attribute-value">"<a href="/pipeline/modules/word-to-dtbook/src/main/resources/xml/Common2.xsl" class="source">Common2.xsl</a>"</span>/&gt;
	
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">import</span> <span class="code-xml-attribute-local-name">href</span>=<span class="code-xml-attribute-value">"<a href="/pipeline/modules/word-to-dtbook/src/main/resources/xml/Common3.xsl" class="source">Common3.xsl</a>"</span>/&gt;
	
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">import</span> <span class="code-xml-attribute-local-name">href</span>=<span class="code-xml-attribute-value">"<a href="/pipeline/modules/word-to-dtbook/src/main/resources/xml/OOML2MML.xsl" class="source">OOML2MML.xsl</a>"</span>/&gt;
	
	
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">output</span> <span class="code-xml-attribute-local-name">method</span>=<span class="code-xml-attribute-value">"xml"</span> <span class="code-xml-attribute-local-name">indent</span>=<span class="code-xml-attribute-value">"no"</span>/&gt;
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sOperators"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"concat(     '!"()+,-/⫾:;&lt;',     '=&gt;?[\]{|}¡¬±',     '·¿×÷        ',     ' ‐‒–—‖†‡•․‥…',     '‼⁀⁎⁏⁐ ⁡⁢⁣⅀←↑',     '→↓↔↕↖↗↘↙↚↛↜↝',     '↞↟↠↡↢↣↤↥↦↧↨↩',     '↪↫↬↭↮↯↰↱↲↳↶↷',     '↺↻↼↽↾↿⇀⇁⇂⇃⇄⇅',     '⇆⇇⇈⇉⇊⇋⇌⇍⇎⇏⇐⇑',     '⇒⇓⇔⇕⇖⇗⇘⇙⇚⇛⇜⇝',     '⇞⇟⇠⇡⇢⇣⇤⇥⇦⇧⇨⇩',     '⇴⇵⇶⇷⇸⇹⇺⇻⇼⇽⇾⇿',     '∀∁∂∃∄∆∇∈∉∊∋∌',     '∍∏∐∑−∓∔∕∖∗∘∙',     '√∛∜∝∣∤∥∦∧∨∩∪',     '∫∬∭∮∯∰∱∲∳∴∵∶',     '∷∸∹∺∻∼∽∾≀≁≂≃',     '≄≅≆≇≈≉≊≋≌≍≎≏',     '≐≑≒≓≔≕≖≗≘≙≚≛',     '≜≝≞≟≠≡≢≣≤≥≦≧',     '≨≩≪≫≬≭≮≯≰≱≲≳',     '≴≵≶≷≸≹≺≻≼≽≾≿',     '⊀⊁⊂⊃⊄⊅⊆⊇⊈⊉⊊⊋',     '⊌⊍⊎⊏⊐⊑⊒⊓⊔⊕⊖⊗',     '⊘⊙⊚⊛⊜⊝⊞⊟⊠⊡⊢⊣',     '⊥⊦⊧⊨⊩⊪⊫⊬⊭⊮⊯⊰',     '⊱⊲⊳⊴⊵⊶⊷⊸⊹⊺⊻⊼',     '⊽⋀⋁⋂⋃⋄⋅⋆⋇⋈⋉⋊',     '⋋⋌⋍⋎⋏⋐⋑⋒⋓⋔⋕⋖',     '⋗⋘⋙⋚⋛⋜⋝⋞⋟⋠⋡⋢',     '⋣⋤⋥⋦⋧⋨⋩⋪⋫⋬⋭⋮',     '⋯⋰⋱⋲⋳⋴⋵⋶⋷⋸⋹⋺',     '⋻⋼⋽⋾⋿⌅⌆⌈⌉⌊⌋⌜',     '⌝⌞⌟⌢⌣〈〉⌽⌿⎰⎱▲',     '△▴▵▶▷▸▹▼▽▾▿◀',     '◁◂◃◄◅◊○◦◫◬◸◹',     '◺◻◼◽◾◿★☆❲❳⟑⟒',     '⟓⟔⟕⟖⟗⟘⟙⟚⟛⟜⟝⟞',     '⟟⟠⟡⟢⟣⟤⟥⟦⟧⟨⟩⟪',     '⟫⟰⟱⟲⟳⟴⟵⟶⟷⟸⟹⟺',     '⟻⟼⟽⟾⟿⤀⤁⤂⤃⤄⤅⤆',     '⤇⤈⤉⤊⤋⤌⤍⤎⤏⤐⤑⤒',     '⤓⤔⤕⤖⤗⤘⤙⤚⤛⤜⤝⤞',     '⤟⤠⤡⤢⤣⤤⤥⤦⤧⤨⤩⤪',     '⤫⤬⤭⤮⤯⤰⤱⤲⤳⤴⤵⤶',     '⤷⤸⤹⤺⤻⤼⤽⤾⤿⥀⥁⥂',     '⥃⥄⥅⥆⥇⥈⥉⥊⥋⥌⥍⥎',     '⥏⥐⥑⥒⥓⥔⥕⥖⥗⥘⥙⥚',     '⥛⥜⥝⥞⥟⥠⥡⥢⥣⥤⥥⥦',     '⥧⥨⥩⥪⥫⥬⥭⥮⥯⥰⥱⥲',     '⥳⥴⥵⥶⥷⥸⥹⥺⥻⥼⥽⥾',     '⥿⦀⦂⦃⦄⦅⦆⦇⦈⦉⦊⦋',     '⦌⦍⦎⦏⦐⦑⦒⦓⦔⦕⦖⦗',     '⦘⦙⦚⦶⦷⦸⦹⧀⧁⧄⧅⧆',     '⧇⧈⧎⧏⧐⧑⧒⧓⧔⧕⧖⧗',     '⧘⧙⧚⧛⧟⧡⧢⧣⧤⧥⧦⧫',     '⧴⧵⧶⧷⧸⧹⧺⧻⧼⧽⧾⧿',     '⨀⨁⨂⨃⨄⨅⨆⨇⨈⨉⨊⨋',     '⨌⨍⨎⨏⨐⨑⨒⨓⨔⨕⨖⨗',     '⨘⨙⨚⨛⨜⨝⨞⨟⨠⨡⨢⨣',     '⨤⨥⨦⨧⨨⨩⨪⨫⨬⨭⨮⨯',     '⨰⨱⨲⨳⨴⨵⨶⨷⨸⨹⨺⨻',     '⨼⨽⨾⨿⩀⩁⩂⩃⩄⩅⩆⩇',     '⩈⩉⩊⩋⩌⩍⩎⩏⩐⩑⩒⩓',     '⩔⩕⩖⩗⩘⩙⩚⩛⩜⩝⩞⩟',     '⩠⩡⩢⩣⩤⩥⩦⩧⩨⩩⩪⩫',     '⩬⩭⩮⩯⩰⩱⩲⩳⩴⩵⩶⩷',     '⩸⩹⩺⩻⩼⩽⩾⩿⪀⪁⪂⪃',     '⪄⪅⪆⪇⪈⪉⪊⪋⪌⪍⪎⪏',     '⪐⪑⪒⪓⪔⪕⪖⪗⪘⪙⪚⪛',     '⪜⪝⪞⪟⪠⪡⪢⪣⪤⪥⪦⪧',     '⪨⪩⪪⪫⪬⪭⪮⪯⪰⪱⪲⪳',     '⪴⪵⪶⪷⪸⪹⪺⪻⪼⪽⪾⪿',     '⫀⫁⫂⫃⫄⫅⫆⫇⫈⫉⫊⫋',     '⫌⫍⫎⫏⫐⫑⫒⫓⫔⫕⫖⫗',     '⫘⫙⫚⫛⫝̸⫝⫞⫟⫠⫢⫣⫤',     '⫥⫦⫧⫨⫩⫪⫫⫬⫭⫮⫯⫰',     '⫲⫳⫴⫵⫶⫷⫸⫹⫺⫻⫼⫽')"</span>/&gt;
	
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sMinuses"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span>&gt;
		&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">call-template</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"SRepeatChar"</span>&gt;
			&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"cchRequired"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"string-length($sOperators)"</span>/&gt;
			&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"ch"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"'-'"</span>/&gt;
		&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">call-template</span>&gt;
	&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span>&gt;
	
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sNumbers"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"'0123456789'"</span>/&gt;
	
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sZeros"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span>&gt;
		&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">call-template</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"SRepeatChar"</span>&gt;
			&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"cchRequired"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"string-length($sNumbers)"</span>/&gt;
			&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"ch"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"'0'"</span>/&gt;
		&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">call-template</span>&gt;
	&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span>&gt;
	
	
	
	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">template</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"main"</span>&gt;
		
		
		&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">result-document</span> <span class="code-xml-attribute-local-name">encoding</span>=<span class="code-xml-attribute-value">"utf-8"</span> <span class="code-xml-attribute-local-name">indent</span>=<span class="code-xml-attribute-value">"yes"</span>&gt;
			
			&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">text</span> <span class="code-xml-attribute-local-name">disable-output-escaping</span>=<span class="code-xml-attribute-value">"yes"</span>&gt;&lt;!DOCTYPE dtbook PUBLIC '-//NISO//DTD dtbook 2005-3//EN' 'http://www.daisy.org/z3986/2005/dtbook-2005-3.dtd'&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">text</span>&gt;
			&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"count($documentXml//m:*) &gt; 0"</span>&gt;
				&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">text</span> <span class="code-xml-attribute-local-name">disable-output-escaping</span>=<span class="code-xml-attribute-value">"yes"</span>&gt;[
	&lt;!ENTITY % MATHML.prefixed "INCLUDE" &gt;
	&lt;!ENTITY % MATHML.prefix "mml"&gt;
	&lt;!ENTITY % Schema.prefix "sch"&gt;
	&lt;!ENTITY % XLINK.prefix "xlp"&gt;
	&lt;!ENTITY % MATHML.Common.attrib
		"xlink:href    CDATA       #IMPLIED
		xlink:type     CDATA       #IMPLIED
		class          CDATA       #IMPLIED
		style          CDATA       #IMPLIED
		id             ID          #IMPLIED
		xref           IDREF       #IMPLIED
		other          CDATA       #IMPLIED
		xmlns:dtbook   CDATA       #FIXED
			'http://www.daisy.org/z3986/2005/dtbook/'
		dtbook:smilref CDATA       #IMPLIED"&gt;
	&lt;!ENTITY % mathML2 PUBLIC '-//W3C//DTD MathML 2.0//EN' 'http://www.w3.org/Math/DTD/mathml2/mathml2.dtd'&gt;
	%mathML2;
	&lt;!ENTITY % externalFlow "| mml:math"&gt;
	&lt;!ENTITY % externalNamespaces "xmlns:mml CDATA #FIXED
		'http://www.w3.org/1998/Math/MathML'" &gt;
]&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">text</span>&gt;
			&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
			
			&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">text</span> <span class="code-xml-attribute-local-name">disable-output-escaping</span>=<span class="code-xml-attribute-value">"yes"</span>&gt; &gt;
&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">text</span>&gt;
			&lt;<span class="code-xml-element-local-name">dtbook</span> <span class="code-xml-attribute-local-name">version</span>=<span class="code-xml-attribute-value">"2005-3"</span>&gt;
				&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"count($documentXml//m:*) &gt; 0"</span>&gt;
					&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">namespace</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"mml"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"'http://www.w3.org/1998/Math/MathML'"</span>/&gt;
				&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
				
				
				&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">attribute</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"xml:lang"</span>&gt;
					&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">value-of</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$documentLanguages/*:lang[1]/@*:val"</span>/&gt;
				&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">attribute</span>&gt;
				&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"documentDate"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$docPropsCoreXml//cp:coreProperties/dcterms:modified"</span>/&gt;
				&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"documentSubject"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"d:DocPropSubject($myObj)"</span>/&gt;
				&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"documentDescription"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"d:DocPropDescription($myObj)"</span>/&gt;
				
				&lt;<span class="code-xml-element-local-name">head</span>&gt;
					
					
					&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"Auto"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:string"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"concat('AUTO-UID-',d:GenerateId())"</span>/&gt;
					
					&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">choose</span>&gt;
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">when</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"string-length($uid) = 0"</span>&gt;
							&lt;<span class="code-xml-element-local-name">meta</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dtb:uid"</span> <span class="code-xml-attribute-local-name">content</span>=<span class="code-xml-attribute-value">"{$Auto}"</span>/&gt;
						&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">when</span>&gt;
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">otherwise</span>&gt;
							&lt;<span class="code-xml-element-local-name">meta</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dtb:uid"</span> <span class="code-xml-attribute-local-name">content</span>=<span class="code-xml-attribute-value">"{$uid}"</span>/&gt;
						&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">otherwise</span>&gt;
					&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">choose</span>&gt;
					&lt;<span class="code-xml-element-local-name">meta</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dtb:generator"</span> <span class="code-xml-attribute-local-name">content</span>=<span class="code-xml-attribute-value">"DAISY Pipeline 2 word-to-dtbook 1.0.0"</span>/&gt;
					
					&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">choose</span>&gt;
						
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">when</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"string-length($title) = 0"</span>&gt;
							&lt;<span class="code-xml-element-local-name">meta</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dc:Title"</span> <span class="code-xml-attribute-local-name">content</span>=<span class="code-xml-attribute-value">"{$docPropsCoreXml//cp:coreProperties/dc:title/text()}"</span>/&gt;
						&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">when</span>&gt;
						
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">otherwise</span>&gt;
							&lt;<span class="code-xml-element-local-name">meta</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dc:Title"</span> <span class="code-xml-attribute-local-name">content</span>=<span class="code-xml-attribute-value">"{$title}"</span>/&gt;
						&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">otherwise</span>&gt;
					&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">choose</span>&gt;
					
					
					&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">choose</span>&gt;
						
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">when</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"string-length($creator) = 0"</span>&gt;
							
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"creatorFromPackage"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$docPropsCoreXml//cp:coreProperties/dc:creator/text()"</span>/&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"string-length($creatorFromPackage)!=0"</span>&gt;
								&lt;<span class="code-xml-element-local-name">meta</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dc:Creator"</span> <span class="code-xml-attribute-local-name">content</span>=<span class="code-xml-attribute-value">"{$creatorFromPackage}"</span>/&gt;
							&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
						&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">when</span>&gt;
						
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">otherwise</span>&gt;
							&lt;<span class="code-xml-element-local-name">meta</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dc:Creator"</span> <span class="code-xml-attribute-local-name">content</span>=<span class="code-xml-attribute-value">"{$creator}"</span>/&gt;
						&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">otherwise</span>&gt;
					&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">choose</span>&gt;
					
					
					&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"string-length($documentDate)!=0 and not($disableDateGeneration)"</span>&gt;
						&lt;<span class="code-xml-element-local-name">meta</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dc:Date"</span> <span class="code-xml-attribute-local-name">content</span>=<span class="code-xml-attribute-value">"{substring-before($documentDate,'T')}"</span>/&gt;
					&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
					
					&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">choose</span>&gt;
						
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">when</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"string-length($publisher) = 0"</span>&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"publisherFromPackage"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$docPropsAppXml//ep:Properties/ep:Company/text()"</span>/&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"string-length($publisherFromPackage)!=0"</span>&gt;
								&lt;<span class="code-xml-element-local-name">meta</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dc:Publisher"</span> <span class="code-xml-attribute-local-name">content</span>=<span class="code-xml-attribute-value">"{$publisherFromPackage}"</span>/&gt;
							&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
						&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">when</span>&gt;
						
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">otherwise</span>&gt;
							&lt;<span class="code-xml-element-local-name">meta</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dc:Publisher"</span> <span class="code-xml-attribute-local-name">content</span>=<span class="code-xml-attribute-value">"{$publisher}"</span>/&gt;
						&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">otherwise</span>&gt;
					&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">choose</span>&gt;
					
					
					&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">choose</span>&gt;
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">when</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"string-length($subject)!=0"</span>&gt;
							&lt;<span class="code-xml-element-local-name">meta</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dc:Subject"</span> <span class="code-xml-attribute-local-name">content</span>=<span class="code-xml-attribute-value">"{$subject}"</span>/&gt;
						&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">when</span>&gt;
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">otherwise</span>&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"string-length($documentSubject)!=0"</span>&gt;
								&lt;<span class="code-xml-element-local-name">meta</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dc:Subject"</span> <span class="code-xml-attribute-local-name">content</span>=<span class="code-xml-attribute-value">"{$documentSubject}"</span>/&gt;
							&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
						&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">otherwise</span>&gt;
					&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">choose</span>&gt;
					
					&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"string-length($documentDescription)!=0"</span>&gt;
						&lt;<span class="code-xml-element-local-name">meta</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dc:Description"</span> <span class="code-xml-attribute-local-name">content</span>=<span class="code-xml-attribute-value">"{$documentDescription}"</span>/&gt;
					&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
					
					&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">choose</span>&gt;
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">when</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"string-length($uid) = 0"</span>&gt;
							&lt;<span class="code-xml-element-local-name">meta</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dc:Identifier"</span> <span class="code-xml-attribute-local-name">content</span>=<span class="code-xml-attribute-value">"{$Auto}"</span>/&gt;
						&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">when</span>&gt;
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">otherwise</span>&gt;
							&lt;<span class="code-xml-element-local-name">meta</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dc:Identifier"</span> <span class="code-xml-attribute-local-name">content</span>=<span class="code-xml-attribute-value">"{$uid}"</span>/&gt;
						&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">otherwise</span>&gt;
					&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">choose</span>&gt;
					&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$documentLanguages/*:lang"</span>&gt;
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">sequence</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"d:sink(d:AddLanguage($myObj,@val))"</span>/&gt; 
						&lt;<span class="code-xml-element-local-name">meta</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dc:Language"</span> <span class="code-xml-attribute-local-name">content</span>=<span class="code-xml-attribute-value">"{@val}"</span>/&gt;
					&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span>&gt;
					
					
				&lt;/<span class="code-xml-element-local-name">head</span>&gt;
				
				&lt;<span class="code-xml-element-local-name">book</span> <span class="code-xml-attribute-local-name">showin</span>=<span class="code-xml-attribute-value">"blp"</span>&gt;
					&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"not($MasterSub)"</span>&gt;
						
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$documentXml//w:document/w:body/node()"</span>&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"self::w:p"</span>&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"w:pPr/w:pStyle[substring(@w:val,1,11)='Frontmatter']"</span>&gt;
									&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"d:PushPageStyle($myObj,@w:val)"</span>/&gt;
								&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span>&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"w:pPr/w:pStyle[substring(@w:val,1,10)='Bodymatter']"</span>&gt;
									&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"d:PushPageStyle($myObj,@w:val)"</span>/&gt;
								&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span>&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"w:pPr/w:pStyle[substring(@w:val,1,10)='Rearmatter']"</span>&gt;
									&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"d:PushPageStyle($myObj,@w:val)"</span>/&gt;
								&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span>&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"w:r/w:rPr/w:rStyle[substring(@w:val,1,11)='Frontmatter']"</span>&gt;
									&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"d:PushPageStyle($myObj,@w:val)"</span>/&gt;
								&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span>&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"w:r/w:rPr/w:rStyle[substring(@w:val,1,10)='Bodymatter']"</span>&gt;
									&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"d:PushPageStyle($myObj,@w:val)"</span>/&gt;
								&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span>&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"w:r/w:rPr/w:rStyle[substring(@w:val,1,10)='Rearmatter']"</span>&gt;
									&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"d:PushPageStyle($myObj,@w:val)"</span>/&gt;
								&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span>&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">sequence</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"d:IncrementCheckingParagraph($myObj)"</span>/&gt; 
							&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
						&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span>&gt;
						
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"d:IsInvalidPageStylesSequence($myObj)='true'"</span>&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">message</span> <span class="code-xml-attribute-local-name">terminate</span>=<span class="code-xml-attribute-value">"yes"</span>&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">value-of</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"d:GetPageStylesErrors($myObj)"</span>/&gt;
							&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">message</span>&gt;
						&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
					&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
					
					
					
					&lt;<span class="code-xml-element-local-name">frontmatter</span>&gt;
						&lt;<span class="code-xml-element-local-name">doctitle</span>&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">choose</span>&gt;
								
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">when</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"string-length($title) = 0"</span>&gt;
									&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">value-of</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$docPropsCoreXml//cp:coreProperties/dc:title"</span>/&gt;
								&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">when</span>&gt;
								
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">otherwise</span>&gt;
									&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">value-of</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$title"</span>/&gt;
								&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">otherwise</span>&gt;
							&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">choose</span>&gt;
						&lt;/<span class="code-xml-element-local-name">doctitle</span>&gt;
						&lt;<span class="code-xml-element-local-name">docauthor</span>&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">choose</span>&gt;
								
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">when</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"string-length($creator) = 0"</span>&gt;
									&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">value-of</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$docPropsCoreXml//cp:coreProperties/dc:creator"</span>/&gt;
								&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">when</span>&gt;
								
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">otherwise</span>&gt;
									&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">value-of</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$creator"</span>/&gt;
								&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">otherwise</span>&gt;
							&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">choose</span>&gt;
						&lt;/<span class="code-xml-element-local-name">docauthor</span>&gt;
						
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"        count($documentXml//w:document/w:body/w:p[position() &gt; 1]/w:pPr/w:pStyle[substring(@w:val,1,10)='Bodymatter'])=1        or count($documentXml//w:document/w:body/w:p/w:r[position() &gt; 1]/w:rPr/w:rStyle[substring(@w:val,1,10)='Bodymatter'])=1         "</span>&gt;
							
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">call-template</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"Matter"</span>&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"acceptRevisions"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$acceptRevisions"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"version"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$version"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"pagination"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$pagination"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"masterSub"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$MasterSub"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sOperators"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$sOperators"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sMinuses"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$sMinuses"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sNumbers"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$sNumbers"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sZeros"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$sZeros"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"imgOption"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$ImageSizeOption"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dpi"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$DPI"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"charStyles"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$CharacterStyles"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"matterType"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"'Frontmatter'"</span>/&gt;
							&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">call-template</span>&gt;
						&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
					&lt;/<span class="code-xml-element-local-name">frontmatter</span>&gt;
					
					
					&lt;<span class="code-xml-element-local-name">bodymatter</span> <span class="code-xml-attribute-local-name">id</span>=<span class="code-xml-attribute-value">"bodymatter_0001"</span>&gt;
						&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">call-template</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"Matter"</span>&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"acceptRevisions"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$acceptRevisions"</span>/&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"version"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$version"</span>/&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"pagination"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$pagination"</span>/&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"masterSub"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$MasterSub"</span>/&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sOperators"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$sOperators"</span>/&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sMinuses"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$sMinuses"</span>/&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sNumbers"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$sNumbers"</span>/&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sZeros"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$sZeros"</span>/&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"imgOption"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$ImageSizeOption"</span>/&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dpi"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$DPI"</span>/&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"charStyles"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$CharacterStyles"</span>/&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"matterType"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"'Bodymatter'"</span>/&gt;
						&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">call-template</span>&gt;
					&lt;/<span class="code-xml-element-local-name">bodymatter</span>&gt;
					
					
					&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"(        count($documentXml//w:document/w:body/w:p/w:pPr/w:pStyle[substring(@w:val,1,10)='Rearmatter'])=1        or count($documentXml//w:document/w:body/w:p/w:r/w:rPr/w:rStyle[substring(@w:val,1,10)='Rearmatter'])=1        or count($documentXml//w:document/w:body/w:p/w:r/w:rPr/w:rStyle[@w:val='EndnoteReference']) &gt; 0        or count($documentXml//w:document/w:body/w:p/w:r/w:endnoteReference)  &gt; 0       )"</span>&gt;
						&lt;<span class="code-xml-element-local-name">rearmatter</span>&gt;
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"count(          $documentXml//w:document/w:body/w:p/w:r[           ./w:rPr/w:rStyle[@w:val='EndnoteReference']            or ./w:endnoteReference          ]         )  &gt; 0"</span>&gt;
								
								&lt;<span class="code-xml-element-local-name">level1</span>&gt;
									
									
									&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"(            $documentXml//w:document/w:body/w:p/w:r[             ./w:rPr/w:rStyle[@w:val='EndnoteReference']              or ./w:endnoteReference            ]           )"</span>&gt;
										&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">variable</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"endNoteId"</span> <span class="code-xml-attribute-local-name">as</span>=<span class="code-xml-attribute-value">"xs:integer"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"./w:endnoteReference/@w:id"</span>/&gt;
										&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"$endNoteId &gt; 0"</span>&gt;
											&lt;<span class="code-xml-element-local-name">note</span>&gt;
												
												&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">attribute</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"id"</span>&gt;
													&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">value-of</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"concat('endnote-',$endNoteId)"</span>/&gt;
												&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">attribute</span>&gt;
												
												&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">attribute</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"class"</span>&gt;
													&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">value-of</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"'Endnote'"</span>/&gt;
												&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">attribute</span>&gt;
												
												&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$endnotesXml//w:endnotes/w:endnote"</span>&gt;
													
													&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"@w:id=$endNoteId"</span>&gt;
														
														&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"./node()"</span>&gt;
															
															&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span> <span class="code-xml-attribute-local-name">test</span>=<span class="code-xml-attribute-value">"self::w:p"</span>&gt;
																&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">call-template</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"ParagraphStyle"</span>&gt;
																	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"version"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$version"</span>/&gt;
																	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"flagNote"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"'endnote'"</span>/&gt;
																	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"checkid"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$endNoteId + 1"</span>/&gt;
																	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sOperators"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$sOperators"</span>/&gt;
																	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sMinuses"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$sMinuses"</span>/&gt;
																	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sNumbers"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$sNumbers"</span>/&gt;
																	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sZeros"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$sZeros"</span>/&gt;
																	&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"characterparaStyle"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"false()"</span>/&gt;
																&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">call-template</span>&gt;
															&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
														&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span>&gt;
														&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">sequence</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"d:sink(d:InitializeNoteFlag($myObj))"</span>/&gt; 
													&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
												&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span>&gt;
											&lt;/<span class="code-xml-element-local-name">note</span>&gt;
										&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
									&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">for-each</span>&gt;
								&lt;/<span class="code-xml-element-local-name">level1</span>&gt;
							&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
							
							&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">call-template</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"Matter"</span>&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"acceptRevisions"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$acceptRevisions"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"version"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$version"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"pagination"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$pagination"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"masterSub"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$MasterSub"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sOperators"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$sOperators"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sMinuses"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$sMinuses"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sNumbers"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$sNumbers"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"sZeros"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$sZeros"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"imgOption"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$ImageSizeOption"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"dpi"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$DPI"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"charStyles"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"$CharacterStyles"</span>/&gt;
								&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">with-param</span> <span class="code-xml-attribute-local-name">name</span>=<span class="code-xml-attribute-value">"matterType"</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"'Rearmatter'"</span>/&gt;
							&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">call-template</span>&gt;
						&lt;/<span class="code-xml-element-local-name">rearmatter</span>&gt;
					&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">if</span>&gt;
				&lt;/<span class="code-xml-element-local-name">book</span>&gt;
			&lt;/<span class="code-xml-element-local-name">dtbook</span>&gt;
		&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">result-document</span>&gt;
		&lt;<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">sequence</span> <span class="code-xml-attribute-local-name">select</span>=<span class="code-xml-attribute-value">"d:End($myObj)"</span>/&gt;
	&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">template</span>&gt;
&lt;/<span class="code-xml-element-prefix">xsl:</span><span class="code-xml-element-local-name">stylesheet</span>&gt;</div></body>
</html>
