<?xml version="1.0" encoding="UTF-8"?>
<x:description xmlns:x="http://www.daisy.org/ns/xprocspec"
               xmlns:px="http://www.daisy.org/ns/pipeline/xproc"
               xmlns:d="http://www.daisy.org/ns/pipeline/data"
               script="../../main/resources/xml/daisy3-to-mp3.xpl">

	<x:scenario label="test">
		<x:call step="px:daisy3-to-mp3">
			<x:input port="source.fileset">
				<x:document type="inline" xml:base="../../../../daisy3-to-daisy202/src/test/resources/Chimpanzee/">
					<d:fileset>
						<d:file href="0001.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0002.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0003.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0004.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0005.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0006.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0007.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0008.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0009.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0010.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0011.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0012.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0013.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0014.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0015.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0016.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0017.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0018.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0019.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="0020.smil" media-type="application/smil+xml" media-version="dtb-2005-2"
						        doctype-public="-//NISO//DTD dtbsmil 2005-2//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/dtbsmil-2005-2.dtd"/>
						<d:file href="navigation.ncx" media-type="application/x-dtbncx+xml" media-version="2005-1"
						        doctype-public="-//NISO//DTD ncx 2005-1//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/ncx-2005-1.dtd"/>
						<d:file href="package.opf" media-type="application/oebps-package+xml" media-version="1.2"
						        doctype-public="+//ISBN 0-9673008-1-9//DTD OEB 1.2 Package//EN"
						        doctype-system="http://openebook.org/dtds/oeb-1.2/oebpkg12.dtd"/>
						<d:file href="aud001.mp3" media-type="audio/mpeg"/>
						<d:file href="aud002.mp3" media-type="audio/mpeg"/>
						<d:file href="aud003.mp3" media-type="audio/mpeg"/>
						<d:file href="aud004.mp3" media-type="audio/mpeg"/>
						<d:file href="aud005.mp3" media-type="audio/mpeg"/>
						<d:file href="aud006.mp3" media-type="audio/mpeg"/>
						<d:file href="aud007.mp3" media-type="audio/mpeg"/>
						<d:file href="aud008.mp3" media-type="audio/mpeg"/>
						<d:file href="aud009.mp3" media-type="audio/mpeg"/>
						<d:file href="aud010.mp3" media-type="audio/mpeg"/>
						<d:file href="aud011.mp3" media-type="audio/mpeg"/>
						<d:file href="aud012.mp3" media-type="audio/mpeg"/>
						<d:file href="aud013.mp3" media-type="audio/mpeg"/>
						<d:file href="aud014.mp3" media-type="audio/mpeg"/>
						<d:file href="aud015.mp3" media-type="audio/mpeg"/>
						<d:file href="aud016.mp3" media-type="audio/mpeg"/>
						<d:file href="aud017.mp3" media-type="audio/mpeg"/>
						<d:file href="aud018.mp3" media-type="audio/mpeg"/>
						<d:file href="aud019.mp3" media-type="audio/mpeg"/>
						<d:file href="aud020.mp3" media-type="audio/mpeg"/>
						<d:file href="tpbnarrator.res" media-type="application/x-dtbresource+xml" media-version="2005-1"
						        doctype-public="-//NISO//DTD resource 2005-1//EN"
						        doctype-system="http://www.daisy.org/z3986/2005/resource-2005-1.dtd"/>
						<d:file href="tpbnarrator_res.mp3" media-type="audio/mpeg"/>
					</d:fileset>
				</x:document>
			</x:input>
			<x:input port="source.in-memory"/>
			<x:option name="file-limit" select="[15,-1,-1]"/>
		</x:call>
		<x:scenario label="book-folder-level 0">
			<x:call>
				<x:option name="level-offset" select="0"/>
				<x:option name="output-dir" select="resolve-uri('test/output-dir/0/',$temp-dir)"/>
				<x:option name="temp-dir" select="resolve-uri('test/temp-dir/0/',$temp-dir)"/>
			</x:call>
			<x:context label="the result port">
				<x:document type="port" port="result"/>
			</x:context>
			<x:expect label="the result fileset"
			          type="custom" href="http://www.daisy.org/pipeline/modules/fileset-utils/library.xpl" step="x:fileset-compare">
				<x:document type="inline" base-uri="temp-dir">
					<d:fileset>
						<d:file href="test/output-dir/0/volume%201/001/001/001%20Chimpanzees.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp1.mp3"/>
						<d:file href="test/output-dir/0/volume%201/002/001/001%20Chimpanzees.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp2.mp3"/>
						<d:file href="test/output-dir/0/volume%201/003/001/001%20Library%20of%20Congress%20Cataloging-in-Publication%20Data.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp3.mp3"/>
						<d:file href="test/output-dir/0/volume%201/004/001/001%20Contents.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp4.mp3"/>
						<d:file href="test/output-dir/0/volume%201/005/001/001%20Great%20Apes.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp5.mp3"/>
						<d:file href="test/output-dir/0/volume%201/006/001/001%20Chimpanzees%20And%20People.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp6.mp3"/>
						<d:file href="test/output-dir/0/volume%201/007/001/001%20Talking%20To%20Chimps.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp7.mp3"/>
						<d:file href="test/output-dir/0/volume%201/008/001/001%20What%20They%20Look%20Like.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp8.mp3"/>
						<d:file href="test/output-dir/0/volume%201/009/001/001%20The%20Chimpanzee's%20Home.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp9.mp3"/>
						<d:file href="test/output-dir/0/volume%201/010/001/001%20Everyday%20Life.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp10.mp3"/>
						<d:file href="test/output-dir/0/volume%201/011/001/001%20Chimp%20Communities.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp11.mp3"/>
						<d:file href="test/output-dir/0/volume%201/012/001/001%20Baby%20Chimps.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp12.mp3"/>
						<d:file href="test/output-dir/0/volume%201/013/001/001%20Jane%20Goodall.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp13.mp3"/>
						<d:file href="test/output-dir/0/volume%201/014/001/001%20Important%20Words.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp14.mp3"/>
						<d:file href="test/output-dir/0/volume%201/015/001/001%20Web%20Sites.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp15.mp3"/>
						<d:file href="test/output-dir/0/volume%201/015/002/001%20All%20about%20Chimpanzees.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp16.mp3"/>
						<d:file href="test/output-dir/0/volume%201/015/003/001%20African%20Primates%20at%20Home.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp17.mp3"/>
						<d:file href="test/output-dir/0/volume%201/015/004/001%20Animal%20Bytes:%20Chimpanzee.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp18.mp3"/>
						<d:file href="test/output-dir/0/volume%202/001/001/001%20Index.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp19.mp3"/>
						<d:file href="test/output-dir/0/volume%202/002/001/001%20Questions.mp3" media-type="audio/mpeg" original-href="test/temp-dir/0/tmp20.mp3"/>
					</d:fileset>
				</x:document>
			</x:expect>
		</x:scenario>
		<x:scenario label="book-folder-level 1">
			<x:call>
				<x:option name="level-offset" select="1"/>
				<x:option name="output-dir" select="resolve-uri('test/output-dir/1/',$temp-dir)"/>
				<x:option name="temp-dir" select="resolve-uri('test/temp-dir/1/',$temp-dir)"/>
			</x:call>
			<x:context label="the result port">
				<x:document type="port" port="result"/>
			</x:context>
			<x:expect label="the result fileset"
			          type="custom" href="http://www.daisy.org/pipeline/modules/fileset-utils/library.xpl" step="x:fileset-compare">
				<x:document type="inline" base-uri="temp-dir">
					<d:fileset>
						<d:file href="test/output-dir/1/001/001/001%20Chimpanzees.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp1.mp3"/>
						<d:file href="test/output-dir/1/001/002/001%20Chimpanzees.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp2.mp3"/>
						<d:file href="test/output-dir/1/001/003/001%20Library%20of%20Congress%20Cataloging-in-Publication%20Data.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp3.mp3"/>
						<d:file href="test/output-dir/1/001/004/001%20Contents.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp4.mp3"/>
						<d:file href="test/output-dir/1/001/005/001%20Great%20Apes.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp5.mp3"/>
						<d:file href="test/output-dir/1/001/006/001%20Chimpanzees%20And%20People.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp6.mp3"/>
						<d:file href="test/output-dir/1/001/007/001%20Talking%20To%20Chimps.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp7.mp3"/>
						<d:file href="test/output-dir/1/001/008/001%20What%20They%20Look%20Like.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp8.mp3"/>
						<d:file href="test/output-dir/1/001/009/001%20The%20Chimpanzee's%20Home.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp9.mp3"/>
						<d:file href="test/output-dir/1/001/010/001%20Everyday%20Life.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp10.mp3"/>
						<d:file href="test/output-dir/1/001/011/001%20Chimp%20Communities.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp11.mp3"/>
						<d:file href="test/output-dir/1/001/012/001%20Baby%20Chimps.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp12.mp3"/>
						<d:file href="test/output-dir/1/001/013/001%20Jane%20Goodall.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp13.mp3"/>
						<d:file href="test/output-dir/1/001/014/001%20Important%20Words.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp14.mp3"/>
						<d:file href="test/output-dir/1/001/015/001%20Web%20Sites.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp15.mp3"/>
						<d:file href="test/output-dir/1/001/015/002%20All%20about%20Chimpanzees.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp16.mp3"/>
						<d:file href="test/output-dir/1/001/015/003%20African%20Primates%20at%20Home.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp17.mp3"/>
						<d:file href="test/output-dir/1/001/015/004%20Animal%20Bytes:%20Chimpanzee.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp18.mp3"/>
						<d:file href="test/output-dir/1/001/016/001%20Index.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp19.mp3"/>
						<d:file href="test/output-dir/1/001/017/001%20Questions.mp3" media-type="audio/mpeg" original-href="test/temp-dir/1/tmp20.mp3"/>
					</d:fileset>
				</x:document>
			</x:expect>
		</x:scenario>
		<x:scenario label="book-folder-level 2">
			<x:call>
				<x:option name="level-offset" select="2"/>
				<x:option name="output-dir" select="resolve-uri('test/output-dir/2/',$temp-dir)"/>
				<x:option name="temp-dir" select="resolve-uri('test/temp-dir/2/',$temp-dir)"/>
			</x:call>
			<x:context label="the result port">
				<x:document type="port" port="result"/>
			</x:context>
			<x:expect label="the result fileset"
			          type="custom" href="http://www.daisy.org/pipeline/modules/fileset-utils/library.xpl" step="x:fileset-compare">
				<x:document type="inline" base-uri="temp-dir">
					<d:fileset>
						<d:file href="test/output-dir/2/001/001/001%20Chimpanzees.mp3" media-type="audio/mpeg" original-href="test/temp-dir/2/tmp1.mp3"/>
						<d:file href="test/output-dir/2/001/001/002%20Chimpanzees.mp3" media-type="audio/mpeg" original-href="test/temp-dir/2/tmp2.mp3"/>
						<d:file href="test/output-dir/2/001/001/003%20Library%20of%20Congress%20Cataloging-in-Publication%20Data.mp3" media-type="audio/mpeg" original-href="test/temp-dir/2/tmp3.mp3"/>
						<d:file href="test/output-dir/2/001/001/004%20Contents.mp3" media-type="audio/mpeg" original-href="test/temp-dir/2/tmp4.mp3"/>
						<d:file href="test/output-dir/2/001/001/005%20Great%20Apes.mp3" media-type="audio/mpeg" original-href="test/temp-dir/2/tmp5.mp3"/>
						<d:file href="test/output-dir/2/001/001/006%20Chimpanzees%20And%20People.mp3" media-type="audio/mpeg" original-href="test/temp-dir/2/tmp6.mp3"/>
						<d:file href="test/output-dir/2/001/001/007%20Talking%20To%20Chimps.mp3" media-type="audio/mpeg" original-href="test/temp-dir/2/tmp7.mp3"/>
						<d:file href="test/output-dir/2/001/001/008%20What%20They%20Look%20Like.mp3" media-type="audio/mpeg" original-href="test/temp-dir/2/tmp8.mp3"/>
						<d:file href="test/output-dir/2/001/001/009%20The%20Chimpanzee's%20Home.mp3" media-type="audio/mpeg" original-href="test/temp-dir/2/tmp9.mp3"/>
						<d:file href="test/output-dir/2/001/001/010%20Everyday%20Life.mp3" media-type="audio/mpeg" original-href="test/temp-dir/2/tmp10.mp3"/>
						<d:file href="test/output-dir/2/001/001/011%20Chimp%20Communities.mp3" media-type="audio/mpeg" original-href="test/temp-dir/2/tmp11.mp3"/>
						<d:file href="test/output-dir/2/001/001/012%20Baby%20Chimps.mp3" media-type="audio/mpeg" original-href="test/temp-dir/2/tmp12.mp3"/>
						<d:file href="test/output-dir/2/001/001/013%20Jane%20Goodall.mp3" media-type="audio/mpeg" original-href="test/temp-dir/2/tmp13.mp3"/>
						<d:file href="test/output-dir/2/001/001/014%20Important%20Words.mp3" media-type="audio/mpeg" original-href="test/temp-dir/2/tmp14.mp3"/>
						<d:file href="test/output-dir/2/001/001/015%20Web%20Sites.mp3" media-type="audio/mpeg" original-href="test/temp-dir/2/tmp15.mp3"/>
						<d:file href="test/output-dir/2/001/001/016%20Index.mp3" media-type="audio/mpeg" original-href="test/temp-dir/2/tmp16.mp3"/>
						<d:file href="test/output-dir/2/001/001/017%20Questions.mp3" media-type="audio/mpeg" original-href="test/temp-dir/2/tmp17.mp3"/>
					</d:fileset>
				</x:document>
			</x:expect>
		</x:scenario>
	</x:scenario>

</x:description>
