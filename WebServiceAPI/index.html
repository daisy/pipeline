<!DOCTYPE html>
<html lang="en">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta charset="utf-8">
    <meta http-equiv="content-language" content="en">
    <title>Web Service API</title>
    
  <meta prefix="dc: http://purl.org/dc/elements/1.1/" property="dc:title" content="Web Service API">


    <link rel="stylesheet" href="/pipeline/css/default.css">
    <link rel="stylesheet" href="/pipeline/css/wiki.css">
    <link rel="stylesheet" href="/pipeline/css/coderay.css">
    <link rel="shortcut icon" href="http://www.daisy.org/sites/default/files/favicon_0.ico">

  </head>
  <body>
    <div id="body">
      <nav id="nav-sitemap">
  
  <ul class="spine spine-has-current">
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline" tabindex="1">
      
      Home
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/Download.html" tabindex="2">
      
      Download
      </a>
    
    </li>
  
    
      
        <li class="spine-item spine-item-has-current">
      
      <a href="/pipeline/Get-Help" tabindex="3">
      Help
      </a>
      
      <ul class="spine spine-has-current" id="nav-sitemap-left">
  
    
      
        <li class="spine-item">
      
      <a href="/pipeline/Get-Help/User-Guide" tabindex="6">
      User Guide
      </a>
      
      <ul class="spine">
  
    
      
        <li class="spine-item">
      
      <a href="/pipeline/Get-Help/User-Guide/Installation" tabindex="7">
      Installation
      </a>
      
      <ul class="spine">
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/Get-Help/User-Guide/Web-Application/Installation-and-configuation" tabindex="8">
      
      Web Application
      </a>
    
    </li>
  
</ul>

    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/Get-Help/User-Guide/Desktop-Application/DAISY-Pipeline-2-User-Guide" tabindex="9">
      
      Desktop Application
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      <a href="/pipeline/Get-Help/User-Guide/Web-Application/User-Guide" tabindex="10">
      Web Application
      </a>
      
      <ul class="spine">
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/Get-Help/User-Guide/Web-Application/Templating" tabindex="11">
      
      Templating
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/Get-Help/User-Guide/Web-Application/Administrator-settings" tabindex="12">
      
      Administrator Settings
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/Get-Help/User-Guide/Web-Application/Branding" tabindex="13">
      
      Branding
      </a>
    
    </li>
  
</ul>

    
    </li>
  
    
      
        <li class="spine-item">
      
      <a href="/pipeline/Get-Help/User-Guide/Pipeline-as-Service" tabindex="14">
      Pipeline as a Service
      </a>
      
      <ul class="spine">
  
    
      
        <li class="spine-item">
      
      <a href="/pipeline/Configuration-Files" tabindex="15">
      Configuration Files
      </a>
      
      <ul class="spine">
  
    
      
        <li class="spine-item">
      
      
        <a href="https://daisy.github.io/pipeline/modules/tts-common/doc/tts-config.html" class="external-link" target="_blank" tabindex="16">
      
      Text-To-Speech Configuration
      </a>
    
    </li>
  
</ul>

    
    </li>
  
</ul>

    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/Get-Help/User-Guide/Command-Line" tabindex="17">
      
      Command Line
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      <a href="/pipeline/Get-Help/User-Guide/Scripts" tabindex="18">
      Scripts
      </a>
      
      <ul class="spine">
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/daisy202-validator/doc" tabindex="19">
      
      DAISY 2.02 Validator
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/daisy202-to-epub3/doc" tabindex="20">
      
      DAISY 2.02 to EPUB 3
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/daisy3-to-daisy202/doc" tabindex="21">
      
      DAISY 3 to DAISY 2.02
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/daisy3-to-epub3/doc" tabindex="22">
      
      DAISY 3 to EPUB 3
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/dtbook-validator/doc" tabindex="23">
      
      DTBook Validator
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/dtbook-to-daisy3/doc" tabindex="24">
      
      DTBook to DAISY 3
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/dtbook-to-epub3/doc" tabindex="25">
      
      DTBook to EPUB3
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/dtbook-to-html/doc" tabindex="26">
      
      DTBook to HTML
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/dtbook-to-odt/doc" tabindex="27">
      
      DTBook to ODT
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/braille/dtbook-to-pef/doc" tabindex="28">
      
      DTBook to PEF
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/dtbook-to-rtf/doc" tabindex="29">
      
      DTBook to RTF
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/dtbook-to-zedai/doc" tabindex="30">
      
      DTBook to ZedAI
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/epub2-to-epub3/doc" tabindex="31">
      
      EPUB 2 to EPUB 3
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/epub3-to-epub3/doc" tabindex="32">
      
      EPUB 3 Enhancer
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/epub3-validator/doc" tabindex="33">
      
      EPUB 3 Validator
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/epub3-to-daisy202/doc" tabindex="34">
      
      EPUB 3 to DAISY 2.02
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/epub3-to-daisy3/doc" tabindex="35">
      
      EPUB 3 to DAISY 3
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/braille/epub3-to-pef/doc" tabindex="36">
      
      EPUB 3 to PEF
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/epub-to-daisy/doc" tabindex="37">
      
      EPUB to DAISY
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/html-to-dtbook/doc" tabindex="38">
      
      HTML to DTBook
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/html-to-epub3/doc" tabindex="39">
      
      HTML to EPUB3
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/braille/html-to-pef/doc" tabindex="40">
      
      HTML to PEF
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/nimas-fileset-validator/doc" tabindex="41">
      
      NIMAS Fileset Validator
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/zedai-to-epub3/doc" tabindex="42">
      
      ZedAI to EPUB 3
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/zedai-to-html/doc" tabindex="43">
      
      ZedAI to HTML
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/modules/braille/zedai-to-pef/doc" tabindex="44">
      
      ZedAI to PEF
      </a>
    
    </li>
  
</ul>

    
    </li>
  
</ul>

    
    </li>
  
    
      
        <li class="spine-item spine-item-has-current">
      
      <a href="/pipeline/Get-Help/API-Documentation" tabindex="45">
      API Documentation
      </a>
      
      <ul class="spine spine-has-current">
  
    
      
        <li class="spine-item spine-item-current">
      
      
        <a href="/pipeline/WebServiceAPI" tabindex="46">
      
      Web Service API
      </a>
    
    </li>
  
</ul>

    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/Get-Help/Issue-Tracker.html" tabindex="47">
      
      Issue Tracker
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      <a href="/pipeline/Get-Help/Troubleshooting" tabindex="48">
      Troubleshooting
      </a>
      
      <ul class="spine">
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/Get-Help/Troubleshooting/Common-Errors-Windows" tabindex="49">
      
      Troubleshooting on Windows
      </a>
    
    </li>
  
</ul>

    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="https://github.com/daisy/pipeline/discussions" class="external-link" target="_blank" tabindex="50">
      
      Forum
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="mailto:daisy-pipeline@mail.daisy.org" tabindex="51">
      
      Contact
      </a>
    
    </li>
  
</ul>

    
    </li>
  
    
      
        <li class="spine-item">
      
      <a href="/pipeline/Contribute" tabindex="4">
      Contribute​
      </a>
      
      <ul class="spine">
  
    
      
        <li class="spine-item">
      
      
        <a href="https://github.com/daisy/pipeline" class="external-link" target="_blank" tabindex="52">
      
      Source Code
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="https://groups.google.com/forum/#!forum/daisy-pipeline-dev" class="external-link" target="_blank" tabindex="53">
      
      Developers Mailing List
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      <a href="/pipeline/Contribute/Developer-Guide" tabindex="54">
      Developer Guide
      </a>
      
      <ul class="spine">
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/Contribute/Developer-Guide/Sources" tabindex="55">
      
      Source Code
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/Contribute/Developer-Guide/Building" tabindex="56">
      
      Build System
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      <a href="/pipeline/Contribute/Developer-Guide/XProc" tabindex="57">
      XProc
      </a>
      
      <ul class="spine">
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/XProcExtensions" tabindex="58">
      
      XProc Extensions
      </a>
    
    </li>
  
</ul>

    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/Contribute/Developer-Guide/Testing" tabindex="59">
      
      Testing
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/Contribute/Developer-Guide/Debugging" tabindex="60">
      
      Debugging
      </a>
    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/Contribute/Developer-Guide/Releasing" tabindex="61">
      
      Release Management
      </a>
    
    </li>
  
</ul>

    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="/pipeline/Contribute/Easy-Hacks.html" tabindex="62">
      
      Easy Hacks
      </a>
    
    </li>
  
</ul>

    
    </li>
  
    
      
        <li class="spine-item">
      
      
        <a href="http://www.daisy.org" class="external-link" target="_blank" tabindex="5">
      
      DAISY Home
      </a>
    
    </li>
  
</ul>

</nav>



<script type="text/javascript">
var onload = function() {
  var nav = document.getElementById('nav-sitemap');
  var navTopBefore = nav.offsetTop;
  var fixed = (navTopBefore < window.pageYOffset);
  if (fixed) {
    nav.classList.add('fixed');
  }
  // FIXME: this is a hack! styling should not be handled here!
  var body = document.getElementsByTagName('body')[0];
  var leftNav = document.getElementById('nav-sitemap-left');
  var setLeftNavHeight = function() {
    if (fixed) {
      leftNav.style.height = (window.innerHeight - 34) + "px";
    } else {
      leftNav.style.height = Math.max(window.innerHeight - 219, body.offsetHeight - 175) + "px";
	  // "height: auto" doesn't work if the auto height of leftNav is greater
	  // than window.innerHeight and body.offsetHeight: it would mess up the
	  // transition because the transition would influence the pageYOffset
	  // and thereby canceling itself, making it impossible to scroll down.
    }
  }
  setLeftNavHeight();
  window.onscroll = function(e) {
    if (fixed && window.pageYOffset < navTopBefore) {
      nav.classList.remove('fixed');
	  fixed = false;
      setLeftNavHeight();
    } else if (!fixed && window.pageYOffset > navTopBefore) {
      nav.classList.add('fixed');
	  fixed = true;
      setLeftNavHeight();
    }
  }
  window.onresize = setLeftNavHeight;
};
if (window.addEventListener) {
  window.addEventListener('load', onload);
} else {
  window.attachEvent('onload', onload);
}
</script>


      <div class="edit-button">
  <a href="https://github.com/daisy/pipeline/wiki/WebServiceAPI/_edit" class="external-link" target="_blank">
    Edit this page on Github
  </a>
</div>

      <!--
summary Web Service API documentation
-->

<h1 id="web-service-api">Web Service API</h1>

<p>This document outlines the web service API for the DAISY Pipeline.</p>

<h2 id="resources">Resources</h2>

<p>RESTful web services describe a system in terms of its resources.
Generally speaking, resources can be created, retrieved, modified, and
deleted.</p>

<p>The main resources in this web service are <em>scripts</em>, <em>jobs</em>,
<em>clients</em> and <em>data-types</em>.</p>

<p>A <em>script</em> is a Pipeline XProc script. The script is identified with a
unique URI. It is described in terms of its functionality and all of
its inputs and options.</p>

<p>A <em>job</em> is the execution of a script. Jobs have unique IDs and are
created using input and option values. Jobs produce downloadable
results.</p>

<p>A <em>client</em> is an application using the Pipeline via its API. Examples
of clients are web applications and command line utilities. A client
is not a human user.</p>

<p>A <em>data type</em> determines the possible values a script option can
take. It is defined in an XML syntax (a subset of RelaxNG).</p>

<h2 id="accessing-resources">Accessing Resources</h2>

<p>RESTful applications communicate via HTTP and use standard methods and
<a href="http://en.wikipedia.org/wiki/List_of_HTTP_status_codes" class="external-link" target="_blank">status codes</a>
to create, get, and delete resources.</p>

<p>The following HTTP methods are used here:</p>

<ul>
  <li><code>GET</code></li>
  <li><code>POST</code></li>
  <li><code>PUT</code></li>
  <li><code>DELETE</code></li>
</ul>

<p>Every method is not implemented for every resource because in some
cases, the method wouldn’t be relevant. Any unimplemented methods will
respond with HTTP 405 “Method Not Allowed”.</p>

<h2 id="the-api">The API</h2>

<h3 id="ws-status">WS Status</h3>

<ul>
  <li>HTTP Method: <code>GET</code>
</li>
  <li>URI: <code>/alive</code>
</li>
  <li>Response(s):
    <ul>
      <li>
<code>HTTP 200 OK</code>: Response body contains XML data. See a
<a href="https://raw.githubusercontent.com/daisy/pipeline-framework/master/webservice/doc/xml-formats/alive.xml" class="external-link" target="_blank">sample response document</a>.</li>
    </ul>
  </li>
</ul>

<h3 id="scripts">Scripts</h3>

<h4 id="get-all-scripts">Get all scripts</h4>

<ul>
  <li>HTTP Method: <code>GET</code>
</li>
  <li>URI: <code>/scripts</code>
</li>
  <li>Query parameters:
    <ul>
      <li>See <a href="#authentication">Authentication</a>
</li>
    </ul>
  </li>
  <li>Response(s):
    <ul>
      <li>
<code>HTTP 200 OK</code>: Response body contains XML data. See a
<a href="https://raw.githubusercontent.com/daisy/pipeline-framework/master/webservice/doc/xml-formats/scripts.xml" class="external-link" target="_blank">sample response document</a>.</li>
      <li>
<code>HTTP 401 Unauthorized</code>: Client was not authorized to perform request.</li>
    </ul>
  </li>
</ul>

<h4 id="get-a-single-script">Get a single script</h4>

<ul>
  <li>HTTP Method: <code>GET</code>
</li>
  <li>URI: <code>/scripts/$ID</code>
    <ul>
      <li>Where $ID is the script’s ID</li>
    </ul>
  </li>
  <li>Query parameters
    <ul>
      <li>See <a href="#authentication">Authentication</a>
</li>
    </ul>
  </li>
  <li>Response(s):
    <ul>
      <li>
<code>HTTP 200 OK</code>: Response body contains XML data. See a
<a href="https://raw.githubusercontent.com/daisy/pipeline-framework/master/webservice/doc/xml-formats/script.xml" class="external-link" target="_blank">sample response document</a>.</li>
      <li>
<code>HTTP 401 Unauthorized</code>: Client was not authorized to perform request.</li>
      <li>
<code>HTTP 404 Not Found</code>: Resource not found</li>
    </ul>
  </li>
</ul>

<h3 id="jobs">Jobs</h3>

<h4 id="create-a-job">Create a job</h4>

<ul>
  <li>HTTP Method: <code>POST</code>
</li>
  <li>URI: <code>/jobs</code>
</li>
  <li>Query parameters:
    <ul>
      <li>See <a href="#authentication">Authentication</a>
</li>
    </ul>
  </li>
  <li>Request body:
    <ul>
      <li>jobRequest XML. See two different sample documents
<a href="https://raw.githubusercontent.com/daisy/pipeline-framework/master/webservice/doc/xml-formats/jobRequest2.xml" class="external-link" target="_blank">inline</a>
and
<a href="https://raw.githubusercontent.com/daisy/pipeline-framework/master/webservice/doc/xml-formats/jobRequest1.xml" class="external-link" target="_blank">multipart</a>.</li>
    </ul>
  </li>
  <li>Response(s):
    <ul>
      <li>
<code>HTTP 201 Created</code>: Response body contains XML data about the new
resource. See a
<a href="https://raw.githubusercontent.com/daisy/pipeline-framework/master/webservice/doc/xml-formats/job.xml" class="external-link" target="_blank">sample document</a>.</li>
      <li>
<code>HTTP 400 Bad Request</code>: The request was invalid</li>
      <li>
<code>HTTP 401 Unauthorized</code>: Client was not authorized to perform request.</li>
    </ul>
  </li>
</ul>

<p><a href="/pipeline/WebServiceCreateJob">Read more about creating jobs</a>.</p>

<h4 id="get-all-jobs">Get all jobs</h4>

<ul>
  <li>HTTP Method: <code>GET</code>
</li>
  <li>URI: <code>/jobs</code>
</li>
  <li>Query parameters:
    <ul>
      <li>See <a href="#authentication">Authentication</a>
</li>
    </ul>
  </li>
  <li>Response(s):
    <ul>
      <li>
<code>HTTP 200 OK</code>: Response body contains XML data. See a
<a href="https://raw.githubusercontent.com/daisy/pipeline-framework/master/webservice/doc/xml-formats/jobs.xml" class="external-link" target="_blank">sample response document</a>.</li>
      <li>
<code>HTTP 401 Unauthorized</code>: Client was not authorized to perform request.</li>
    </ul>
  </li>
</ul>

<h4 id="get-a-single-job">Get a single job</h4>

<ul>
  <li>HTTP Method: <code>GET</code>
</li>
  <li>URI: <code>/jobs/$ID</code>
    <ul>
      <li>Where $ID is the job’s unique ID</li>
    </ul>
  </li>
  <li>Query parameters:
    <ul>
      <li>
<code>msgSeq</code> (optional): Returned job status messages will be a
subset of messages where the sequence values are greater than
that provided.  The default is 0. This parameter allows
incremental reporting on job status; i.e. “only return messages
newer than X”.</li>
      <li>See <a href="#authentication">Authentication</a>
</li>
    </ul>
  </li>
  <li>Response(s):
    <ul>
      <li>
<code>HTTP 200 OK</code>: Response body contains XML data. See a
<a href="https://raw.githubusercontent.com/daisy/pipeline-framework/master/webservice/doc/xml-formats/job.xml" class="external-link" target="_blank">sample response document</a>.</li>
      <li>
<code>HTTP 401 Unauthorized</code>: Client was not authorized to perform request.</li>
      <li>
<code>HTTP 404 Not Found</code>: Resource not found</li>
    </ul>
  </li>
</ul>

<h4 id="delete-a-single-job">Delete a single job</h4>

<ul>
  <li>HTTP Method: <code>DELETE</code>
</li>
  <li>URI: <code>/jobs/$ID</code>
    <ul>
      <li>Where $ID is the job’s unique ID</li>
    </ul>
  </li>
  <li>Query parameters:
    <ul>
      <li>See <a href="#authentication">Authentication</a>
</li>
    </ul>
  </li>
  <li>Response(s):
    <ul>
      <li>
<code>HTTP 204 No Content</code>: Successfully processed the request, no content being returned</li>
      <li>
<code>HTTP 401 Unauthorized</code>: Client was not authorized to perform request.</li>
      <li>
<code>HTTP 404 Not Found</code>: Resource not found</li>
    </ul>
  </li>
</ul>

<h4 id="get-the-result-for-a-job">Get the result for a job</h4>

<ul>
  <li>HTTP Method: <code>GET</code>
</li>
  <li>URI: <code>/jobs/$ID/result[/$TYPE/$NAME[/idx/$IDX]]</code>
    <ul>
      <li>Where $ID is the job’s unique ID</li>
      <li>$TYPE is whether port or option</li>
      <li>$NAME is the port or option name</li>
      <li>$IDX is the index of a single output within the port/option.</li>
      <li>An <a href="https://raw.githubusercontent.com/daisy/pipeline-framework/master/webservice/doc/xml-formats/job.xml" class="external-link" target="_blank">example</a> of a result description in the job xml format.</li>
    </ul>
  </li>
  <li>Query parameters:
    <ul>
      <li>See <a href="#authentication">Authentication</a>
</li>
    </ul>
  </li>
  <li>Response(s):
    <ul>
      <li>
<code>HTTP 200 OK</code>: Response body contains Zip data</li>
      <li>
<code>HTTP 401 Unauthorized</code>: Client was not authorized to perform request.</li>
      <li>
<code>HTTP 404 Not Found</code>: Resource not found</li>
    </ul>
  </li>
</ul>

<h4 id="get-the-log-file-for-a-job">Get the log file for a job</h4>

<ul>
  <li>HTTP Method: <code>GET</code>
</li>
  <li>URI: <code>/jobs/$ID/log</code>
    <ul>
      <li>Where $ID is the job’s unique ID</li>
    </ul>
  </li>
  <li>Query parameters:
    <ul>
      <li>See <a href="#authentication">Authentication</a>
</li>
    </ul>
  </li>
  <li>Response(s):
    <ul>
      <li>
<code>HTTP 200 OK</code>: Response body contains a plain text representation of the log file</li>
      <li>
<code>HTTP 401 Unauthorized</code>: Client was not authorized to perform request.</li>
      <li>
<code>HTTP 404 Not Found</code>: Resource not found</li>
    </ul>
  </li>
</ul>

<h3 id="data-types">Data types</h3>

<h4 id="get-all-data-types">Get all data types</h4>

<ul>
  <li>HTTP Method: <code>GET</code>
</li>
  <li>URI: <code>/datatypes</code>
</li>
  <li>Query parameters:
    <ul>
      <li>See <a href="#authentication">Authentication</a>
</li>
    </ul>
  </li>
  <li>Response(s):
    <ul>
      <li>
<code>HTTP 200 OK</code>: Response body contains XML data. The <code>datatypes</code>
 root element has a <code>href</code> attribute, and a <code>datatype</code> child for
 every existing data type. Each <code>datatype</code> element has a <code>href</code>
 atrtibute and an <code>id</code> attribute containing the data type’s unique
 ID.</li>
      <li>
<code>HTTP 401 Unauthorized</code>: Client was not authorized to perform request.</li>
    </ul>
  </li>
</ul>

<h4 id="get-a-single-data-type">Get a single data type</h4>

<ul>
  <li>HTTP Method: <code>GET</code>
</li>
  <li>URI: <code>/datatypes/$ID</code>
    <ul>
      <li>Where $ID is the data type’s unique ID</li>
    </ul>
  </li>
  <li>Query parameters:
    <ul>
      <li>See <a href="#authentication">Authentication</a>
</li>
    </ul>
  </li>
  <li>Response(s):
    <ul>
      <li>
<code>HTTP 200 OK</code>: Response body contains the definition of the data type in XML.</li>
      <li>
<code>HTTP 401 Unauthorized</code>: Client was not authorized to perform request.</li>
      <li>
<code>HTTP 404 Not Found</code>: Resource not found</li>
    </ul>
  </li>
</ul>

<h2 id="admin">Admin</h2>

<p>In addition to managing scripts and jobs, the web service also
provides an administrative interface.  Use of this API is restricted
to use by authorized clients; i.e. those with <code>ADMIN</code> permissions.</p>

<h3 id="stop-the-web-service">Stop the web service</h3>

<ul>
  <li>HTTP Method: <code>GET</code>
</li>
  <li>URI: <code>/admin/halt/$KEY</code>
    <ul>
      <li>Where $KEY is generated by the web service upon startup and stored locally as a text file.</li>
    </ul>
  </li>
  <li>Query parameters:
    <ul>
      <li>See <a href="#authentication">Authentication</a>
</li>
    </ul>
  </li>
  <li>Response(s):
    <ul>
      <li>
<code>HTTP 204 No Content</code>: Successfully processed the request, no content being returned</li>
      <li>
<code>HTTP 401 Unauthorized</code>: Client was not authorized to perform request.</li>
      <li>
<code>HTTP 403 Forbidden</code>: The service could not be halted. This error would be caused by an invalid key.</li>
    </ul>
  </li>
</ul>

<h3 id="get-all-clients">Get all clients</h3>

<ul>
  <li>HTTP Method: <code>GET</code>
</li>
  <li>URI: <code>/admin/clients</code>
</li>
  <li>Query parameters:
    <ul>
      <li>See <a href="#authentication">Authentication</a>
</li>
    </ul>
  </li>
  <li>Response(s):
    <ul>
      <li>
<code>HTTP 200 OK</code>: Response body contains XML data. See a
<a href="https://raw.githubusercontent.com/daisy/pipeline-framework/master/webservice/doc/xml-formats/clients.xml" class="external-link" target="_blank">sample response document</a>.</li>
      <li>
<code>HTTP 401 Unauthorized</code>: Client was not authorized to perform request.</li>
      <li>
<code>HTTP 404 Not Found</code>: Resource not found</li>
    </ul>
  </li>
</ul>

<h3 id="create-a-new-client">Create a new client</h3>

<ul>
  <li>HTTP Method: <code>POST</code>
</li>
  <li>URI: <code>/admin/clients</code>
</li>
  <li>Query parameters:
    <ul>
      <li>See <a href="#authentication">Authentication</a>
</li>
    </ul>
  </li>
  <li>Request body:
    <ul>
      <li>Client XML. See a
<a href="https://raw.githubusercontent.com/daisy/pipeline-framework/master/webservice/doc/xml-formats/client.xml" class="external-link" target="_blank">sample</a>
</li>
    </ul>
  </li>
  <li>Response(s):
    <ul>
      <li>
<code>HTTP 201 Created</code>: Response body contains XML data about the new
resource. See a
<a href="https://raw.githubusercontent.com/daisy/pipeline-framework/master/webservice/doc/xml-formats/client.xml" class="external-link" target="_blank">sample document</a>.</li>
      <li>
<code>HTTP 400 Bad Request</code>: The request was invalid</li>
      <li>
<code>HTTP 401 Unauthorized</code>: Client was not authorized to perform request.</li>
    </ul>
  </li>
</ul>

<h3 id="get-a-single-client">Get a single client</h3>

<ul>
  <li>HTTP Method: <code>GET</code>
</li>
  <li>URI: <code>/admin/clients/$ID</code>
    <ul>
      <li>Where $ID is the client’s unique ID</li>
    </ul>
  </li>
  <li>Query parameters:
    <ul>
      <li>See <a href="#authentication">Authentication</a>
</li>
    </ul>
  </li>
  <li>Response(s):
    <ul>
      <li>
<code>HTTP 200 OK</code>: Response body contains XML data. See a
<a href="https://raw.githubusercontent.com/daisy/pipeline-framework/master/webservice/doc/xml-formats/client.xml" class="external-link" target="_blank">sample response document</a>.</li>
      <li>
<code>HTTP 401 Unauthorized</code>: Client was not authorized to perform request.</li>
      <li>
<code>HTTP 404 Not Found</code>: Resource not found</li>
    </ul>
  </li>
</ul>

<h3 id="delete-a-client">Delete a client</h3>

<ul>
  <li>HTTP Method: <code>DELETE</code>
</li>
  <li>URI: <code>/admin/clients/$ID</code>
    <ul>
      <li>Where $ID is the client’s unique ID</li>
    </ul>
  </li>
  <li>Query parameters:
    <ul>
      <li>See <a href="#authentication">Authentication</a>
</li>
    </ul>
  </li>
  <li>Response(s):
    <ul>
      <li>
<code>HTTP 204 No Content</code>: Successfully processed the request, no content being returned</li>
      <li>
<code>HTTP 401 Unauthorized</code>: Client was not authorized to perform request.</li>
      <li>
<code>HTTP 404 Not Found</code>: Resource not found</li>
    </ul>
  </li>
</ul>

<h3 id="modify-a-client">Modify a client</h3>

<ul>
  <li>HTTP Method: <code>PUT</code>
</li>
  <li>URI: <code>/admin/clients/$ID</code>
    <ul>
      <li>Where $ID is the client’s unique ID</li>
    </ul>
  </li>
  <li>Query parameters:
    <ul>
      <li>See <a href="#authentication">Authentication</a>
</li>
    </ul>
  </li>
  <li>Response(s):
    <ul>
      <li>
<code>HTTP 200 OK</code>: Response body contains XML data about the modified
resource. See a
<a href="https://raw.githubusercontent.com/daisy/pipeline-framework/master/webservice/doc/xml-formats/client.xml" class="external-link" target="_blank">sample response document</a>.</li>
      <li>
<code>HTTP 400 Bad Request</code>: The request was invalid</li>
      <li>
<code>HTTP 401 Unauthorized</code>: Client was not authorized to perform request.</li>
      <li>
<code>HTTP 404 Not Found</code>: Resource not found</li>
    </ul>
  </li>
</ul>

<h3 id="schema">Schema</h3>

<p>Schema for all the XML formats used in this API can be found
<a href="https://github.com/daisy/pipeline-framework/tree/master/webservice/src/main/resources/org/daisy/pipeline/webservice/resources" class="external-link" target="_blank">here</a>.</p>

<h2 id="authentication">Authentication</h2>

<p>When authentication is enabled, the Pipeline only accepts requests
from authorized clients.  In order to become authorized, a client must
be added to the database of clients using the admin API described in
[#Admin].</p>

<p>The client must add the following query parameters to each request:</p>

<ul>
  <li>
<code>authid</code>: Identifies the client application</li>
  <li>
<code>time</code>: Timestamp (UTC)</li>
  <li>
<code>nonce</code>: A unique string generated by the client</li>
  <li>
<code>sign</code>: Hash of the URI string including all query params except this one</li>
</ul>

<p>Note that it is possible to start the web service with authentication
disabled.  This is appropriate when the web service is running only
locally or in other similarly controlled environments.  In this case,
none of the authentication parameters are required, and any that are
sent are ignored.</p>

<p><a href="/pipeline/WebServiceAuthentication">Read more about authentication</a>.</p>

<h2 id="local-file-system-mode">Local File System mode</h2>

<p>The web service is by default run in what is referred to as local FS
mode. The property <code>org.daisy.pipeline.ws.localfs</code> must be set to
change it. In local mode, the web service assumes read/write access to
the disk. Documents that would normally be sent as part of a zip
archive or inline request can be referred to by their local file path
instead. Output options are enabled and output is written to disk
instead of being zipped up for download.</p>

<p>See <a href="https://raw.githubusercontent.com/daisy/pipeline-framework/master/webservice/doc/xml-formats/jobRequest1.localmode.xml" class="external-link" target="_blank">a sample document</a>.</p>

<h2 id="web-service-internal-errors">Web Service internal errors</h2>

<p>In the unlikely but not impossible case that the Pipeline WS suffered
from an internal error, a descriptive xml is returned along with the
HTTP 500 header.</p>

<p>See the <a href="https://raw.githubusercontent.com/daisy/pipeline-framework/master/webservice/doc/xml-formats/error.xml" class="external-link" target="_blank">xml sample document</a>.</p>

    </div>
  </body>
</html>
